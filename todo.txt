+ progress bar on generate csv
+ test and refactor